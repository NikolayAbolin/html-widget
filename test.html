<html>
<head>
<title>Test widget</title>
</head>
<body>
<h3>На этой странице представлен пример изменения внешнего вида и настроек виджета расчёта стоимости доставки заказа.</h3>
<div><u>Для работы виджета на Вашем боевом сервере необходимо заменить публичный ключ из этого примера на свой!!!</u></div>
</br>
<div>В данном примере все цены доставки рассчитываются с учетом повышения на 10%.</div>
<h2>Расчет доставки</h2>
<div id="wtest"></div>
<script type="text/javascript">
(function (d, w, c) {
    (w[c] = w[c] || []).push(function() {
        try {
            w.marschrouteWidget = new Widget({
				public_key: '92786ed521c5e608acce8daa49bf50a3',
				target_id: 'wtest',
				onSubmit: function (delivery, widget) {
					// что-нибудь делаем
					var info = "";
					for (var k in delivery) {
						info += (k+": "+delivery[k]+", ");
					}
					alert(info);
					w.marschrouteWidget.destroy();
				},
				filter: function (delivery) {
					delivery.delivery_cost = delivery.delivery_cost * 1.1; // + 10%
					return delivery; 
				}	
			});
			
			w.marschrouteWidget.open({
			  weight: 1200,
			  sum: 14999,
			  size: [100,100,120]
			});	
        } catch(e) { }
    });
    
    var n = d.getElementsByTagName("script")[0],
        s = d.createElement("script"),
        f = function () { n.parentNode.insertBefore(s, n); };
    s.type = "text/javascript";
    s.async = true;
    s.src = (d.location.protocol == "http:" ? "http:" : "https:") + "//marschroute.ru/widgets/delivery/js/widget.js";

    if (w.opera == "[object Opera]") {
        d.addEventListener("DOMContentLoaded", f);
    } else { f(); }
})(document, window, "marschroute_queue");
</script>
</body>
</html>